MODULE GET_SLICE_NUMBER__genmod
  IMPLICIT NONE
CONTAINS
  FUNCTION GET_SLICE_NUMBER(ICHUNK,IXI,IETA,NPROC_XI,NPROC_ETA) RESULT(slice_number)
    INTEGER(KIND=4), INTENT(IN) :: ICHUNK, IXI, IETA, NPROC_XI, NPROC_ETA
    INTEGER(KIND=4) :: slice_number
    slice_number = (ICHUNK * NPROC_XI * NPROC_ETA) + (IXI * NPROC_ETA) + IETA
  END FUNCTION GET_SLICE_NUMBER
END MODULE GET_SLICE_NUMBER__genmod