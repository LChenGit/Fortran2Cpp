MODULE MDILNBMod
  IMPLICIT NONE
CONTAINS
  INTEGER FUNCTION MDILNB(CHRS)
    CHARACTER(*), INTENT(IN) :: CHRS
    INTEGER :: I

    DO I=LEN(TRIM(CHRS)),1,-1
      IF (CHRS(I:I).NE.' ') THEN
        MDILNB=I
        RETURN
      END IF
    END DO
    MDILNB=1
  END FUNCTION MDILNB
END MODULE MDILNBMod