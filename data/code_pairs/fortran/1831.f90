MODULE deri2_I
  IMPLICIT NONE
  CONTAINS
    SUBROUTINE deri2 (MINEAR, F, FD, FCI, NINEAR, NVAR, GRAD, THROLD, DIAG, SCALAR)
      INTEGER, INTENT(IN) :: NINEAR, MINEAR, NVAR
      REAL(8), DIMENSION(MINEAR,NVAR), INTENT(INOUT) :: F
      REAL(8), DIMENSION(NINEAR,NVAR) :: FD
      REAL(8), DIMENSION(NINEAR,NMECI*(NMECI + 1)*10/NINEAR) :: FCI
      REAL(8), DIMENSION(NVAR), INTENT(INOUT) :: GRAD
      REAL(8), INTENT(IN) :: THROLD
      REAL(8), DIMENSION(*) :: DIAG
      REAL(8), DIMENSION(*), INTENT(IN) :: SCALAR

      INTEGER :: i, j
      DO i = 1, NVAR
        GRAD(i) = 0.0D0
        DO j = 1, MINEAR
          GRAD(i) = GRAD(i) + F(j, i)
        END DO
        GRAD(i) = GRAD(i) / REAL(MINEAR)
      END DO
    END SUBROUTINE deri2
END MODULE deri2_I