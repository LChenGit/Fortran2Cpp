DOUBLE PRECISION FUNCTION DLAMCH(CMACH)
      CHARACTER*1 CMACH
      DOUBLE PRECISION ONE, ZERO, EPS, SFMIN, SMALL, RMACH
      PARAMETER (ONE = 1.0D0, ZERO = 0.0D0)
      EXTERNAL LSAME
      LOGICAL LSAME
      INTRINSIC DIGITS, EPSILON, HUGE, MAXEXPONENT, MINEXPONENT, RADIX, TINY

      RND = ONE
      IF (ONE .EQ. RND) THEN
         EPS = EPSILON(ZERO) * 0.5D0
      ELSE
         EPS = EPSILON(ZERO)
      ENDIF

      IF (LSAME(CMACH, 'E')) THEN
         RMACH = EPS
      ELSE IF (LSAME(CMACH, 'S')) THEN
         SFMIN = TINY(ZERO)
         SMALL = ONE / HUGE(ZERO)
         IF (SMALL .GE. SFMIN) THEN
            SFMIN = SMALL * (ONE + EPS)
         ENDIF
         RMACH = SFMIN
      ELSE IF (LSAME(CMACH, 'B')) THEN
         RMACH = RADIX(ZERO)
      ELSE IF (LSAME(CMACH, 'P')) THEN
         RMACH = EPS * RADIX(ZERO)
      ELSE IF (LSAME(CMACH, 'N')) THEN
         RMACH = DIGITS(ZERO)
      ELSE IF (LSAME(CMACH, 'R')) THEN
         RMACH = RND
      ELSE IF (LSAME(CMACH, 'M')) THEN
         RMACH = MINEXPONENT(ZERO)
      ELSE IF (LSAME(CMACH, 'U')) THEN
         RMACH = TINY(ZERO)
      ELSE IF (LSAME(CMACH, 'L')) THEN
         RMACH = MAXEXPONENT(ZERO)
      ELSE IF (LSAME(CMACH, 'O')) THEN
         RMACH = HUGE(ZERO)
      ELSE
         RMACH = ZERO
      ENDIF

      DLAMCH = RMACH
      RETURN
      END

      DOUBLE PRECISION FUNCTION DLAMC3(A, B)
      DOUBLE PRECISION A, B
      DLAMC3 = A + B
      RETURN
      END