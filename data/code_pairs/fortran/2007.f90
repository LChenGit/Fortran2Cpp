PROGRAM TestSLA_REFCOQ
  IMPLICIT NONE
  DOUBLE PRECISION TDK, PMB, RH, WL, REFA, REFB

  ! Example input values for testing
  TDK = 293.15D0  ! Temperature in Kelvin
  PMB = 1013.25D0 ! Pressure in millibars
  RH = 0.50D0     ! Relative humidity
  WL = 0.70D0     ! Wavelength in micrometers

  CALL sla_REFCOQ(TDK, PMB, RH, WL, REFA, REFB)

  PRINT *, 'REFA:', REFA
  PRINT *, 'REFB:', REFB

END PROGRAM TestSLA_REFCOQ

SUBROUTINE sla_REFCOQ(TDK, PMB, RH, WL, REFA, REFB)
  IMPLICIT NONE
  DOUBLE PRECISION TDK, PMB, RH, WL, REFA, REFB
  LOGICAL OPTIC
  DOUBLE PRECISION T, P, R, W, TDC, PS, PW, WLSQ, GAMMA, BETA

  OPTIC = WL.LE.100D0
  T = MIN(MAX(TDK,100D0),500D0)
  P = MIN(MAX(PMB,0D0),10000D0)
  R = MIN(MAX(RH,0D0),1D0)
  W = MIN(MAX(WL,0.1D0),1D6)

  IF (P.GT.0D0) THEN
     TDC = T-273.15D0
     PS = 10D0**((0.7859D0+0.03477D0*TDC)/(1D0+0.00412D0*TDC))*(1D0+P*(4.5D-6+6D-10*TDC*TDC))
     PW = R*PS/(1D0-(1D0-R)*PS/P)
  ELSE
     PW = 0D0
  END IF

  IF (OPTIC) THEN
     WLSQ = W*W
     GAMMA = ((77.53484D-6+(4.39108D-7+3.666D-9/WLSQ)/WLSQ)*P-11.2684D-6*PW)/T
  ELSE
     GAMMA = (77.6890D-6*P-(6.3938D-6-0.375463D0/T)*PW)/T
  END IF

  BETA = 4.4474D-6*T
  IF (.NOT.OPTIC) BETA = BETA-0.0074D0*PW*BETA

  REFA = GAMMA*(1D0-BETA)
  REFB = -GAMMA*(BETA-GAMMA/2D0)
END SUBROUTINE sla_REFCOQ