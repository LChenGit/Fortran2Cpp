MODULE H5GLOBAL
  IMPLICIT NONE
  INTEGER :: H5P_flags = 0
  INTEGER :: H5P_DEFAULT_F
  EQUIVALENCE(H5P_flags, H5P_DEFAULT_F)
END MODULE H5GLOBAL

MODULE HDF5
  USE H5GLOBAL
END MODULE HDF5

PROGRAM fortranlibtest
  USE HDF5
  IMPLICIT NONE
  INTEGER :: ii
  ii = H5P_DEFAULT_F 

  CALL test_H5P_DEFAULT_F()

CONTAINS

  SUBROUTINE test_H5P_DEFAULT_F()
    USE HDF5
    IMPLICIT NONE

    IF (H5P_DEFAULT_F == 0) THEN
      PRINT *, "TEST PASSED: H5P_DEFAULT_F is correctly defined."
    ELSE
      PRINT *, "TEST FAILED: H5P_DEFAULT_F is not correctly defined."
    END IF
  END SUBROUTINE test_H5P_DEFAULT_F

END PROGRAM fortranlibtest