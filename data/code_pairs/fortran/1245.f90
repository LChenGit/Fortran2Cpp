SUBROUTINE OCTANT1(A_IN, SD_A_IN, MAXX_IN, MAXY_IN, NX, NY, BADDATA, &
                   MAX_SEARCH_RADIUS, MAX_VALUES_PER_OCTANT, IX, IY, &
                   POINTS_FOUND, IX_FOUND, IY_FOUND)
    IMPLICIT NONE
    INTEGER, INTENT(IN) :: MAXX_IN, MAXY_IN, NX, NY, IX, IY, MAX_SEARCH_RADIUS, MAX_VALUES_PER_OCTANT
    REAL, INTENT(IN) :: BADDATA
    REAL, DIMENSION(MAXX_IN, MAXY_IN), INTENT(IN) :: A_IN, SD_A_IN
    INTEGER, DIMENSION(MAX_VALUES_PER_OCTANT), INTENT(OUT) :: IX_FOUND, IY_FOUND
    INTEGER :: IX_SEARCH, IY_SEARCH
    INTEGER, INTENT(OUT) :: POINTS_FOUND

    POINTS_FOUND = 0
    DO IY_SEARCH = IY + 1, MIN(IY + MAX_SEARCH_RADIUS, NY)
        DO IX_SEARCH = IX, MIN(IX + IY_SEARCH - IY - 1, NX)
            IF (A_IN(IX_SEARCH, IY_SEARCH) /= BADDATA .AND. SD_A_IN(IX_SEARCH, IY_SEARCH) /= BADDATA) THEN
                POINTS_FOUND = POINTS_FOUND + 1
                IF (POINTS_FOUND <= MAX_VALUES_PER_OCTANT) THEN
                    IX_FOUND(POINTS_FOUND) = IX_SEARCH
                    IY_FOUND(POINTS_FOUND) = IY_SEARCH
                END IF
                IF (POINTS_FOUND >= MAX_VALUES_PER_OCTANT) THEN
                    RETURN
                END IF
            END IF
        END DO
    END DO
END SUBROUTINE OCTANT1