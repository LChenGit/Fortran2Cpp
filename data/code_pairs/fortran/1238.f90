! RADDDP.f90
SUBROUTINE RADDDP (RAD, SGNA, DEGS, MINS, SECS)
  DOUBLE PRECISION RAD, CON, RADSEC, ZERO, TOL
  REAL SECS
  INTEGER DEGS, MINS, ISEC, INTG
  CHARACTER*1 SGNA, BLANK, NEG
  PARAMETER (RADSEC = 206264.806247D0, ZERO = 0.0D0, TOL = 1.0D-4)
  PARAMETER (BLANK = ' ', NEG = '-')

  CON = ABS(RAD) * RADSEC
  ISEC = INT(CON + TOL)

  SGNA = BLANK
  IF (RAD .LT. ZERO) SGNA = NEG
  IF (CON .LT. TOL) THEN
    CON = ZERO
    DEGS = 0
    MINS = 0
    SECS = 0.0
    RETURN
  END IF

  INTG = ISEC / 3600
  DEGS = INTG
  ISEC = ISEC - INTG * 3600

  MINS = ISEC / 60
  ISEC = ISEC - MINS * 60

  SECS = REAL(ISEC)

END SUBROUTINE RADDDP

PROGRAM TEST_RADDDP
  DOUBLE PRECISION RAD
  CHARACTER*1 SGNA
  INTEGER DEGS, MINS
  REAL SECS

  RAD = 0.12345
  CALL RADDDP(RAD, SGNA, DEGS, MINS, SECS)
  PRINT *, 'Positive radians:', SGNA, DEGS, MINS, SECS

  RAD = -0.12345
  CALL RADDDP(RAD, SGNA, DEGS, MINS, SECS)
  PRINT *, 'Negative radians:', SGNA, DEGS, MINS, SECS
END PROGRAM