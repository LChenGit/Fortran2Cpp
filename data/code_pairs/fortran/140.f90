PROGRAM TestPygamm
  IMPLICIT NONE
  DOUBLE PRECISION PYGAMM
  DOUBLE PRECISION :: result, X
  DOUBLE PRECISION, PARAMETER :: testValues(5) = (/0.5, 1.0, 1.5, 2.0, 10.0/)
  INTEGER :: i

  DO i = 1, 5
     X = testValues(i)
     result = PYGAMM(X)
     PRINT *, 'PYGAMM(', X, ') = ', result
  END DO
END PROGRAM TestPygamm

DOUBLE PRECISION FUNCTION PYGAMM(X)
  IMPLICIT NONE
  DOUBLE PRECISION, INTENT(IN) :: X
  DOUBLE PRECISION :: B(8)
  INTEGER :: NX, I, IX
  DOUBLE PRECISION :: DX, DXP
  DATA B /-0.577191652D0, 0.988205891D0, -0.897056937D0, 0.918206857D0, &
          -0.756704078D0, 0.482199394D0, -0.193527818D0, 0.035868343D0/
  NX = INT(X)
  DX = X - NX
  PYGAMM = 1D0
  DXP = 1D0
  DO I = 1, 8
    DXP = DXP * DX
    PYGAMM = PYGAMM + B(I) * DXP
  END DO
  IF (X .LT. 1D0) THEN
    PYGAMM = PYGAMM / X
  ELSE
    DO IX = 1, NX - 1
      PYGAMM = (X - IX) * PYGAMM
    END DO
  ENDIF
END FUNCTION PYGAMM