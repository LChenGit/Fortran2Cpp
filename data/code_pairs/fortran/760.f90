DOUBLE PRECISION FUNCTION DDWNRM(NEQ, V, RWT)
  IMPLICIT NONE
  INTEGER, INTENT(IN) :: NEQ
  DOUBLE PRECISION, DIMENSION(*), INTENT(IN) :: V, RWT
  DOUBLE PRECISION :: VMAX, SUM
  INTEGER :: I

  DDWNRM = 0.0D0
  VMAX = 0.0D0
  DO I = 1, NEQ
    IF(ABS(V(I)*RWT(I)) .GT. VMAX) VMAX = ABS(V(I)*RWT(I))
  END DO
  IF(VMAX .LE. 0.0D0) RETURN
  SUM = 0.0D0
  DO I = 1, NEQ
    SUM = SUM + ((V(I)*RWT(I))/VMAX)**2
  END DO
  DDWNRM = VMAX*SQRT(SUM/DBLE(NEQ))

  RETURN
END FUNCTION DDWNRM