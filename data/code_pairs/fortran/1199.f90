MODULE SET_THETAPHI_RANGE__genmod
  IMPLICIT NONE
CONTAINS
  SUBROUTINE SET_THETAPHI_RANGE(THETA, PHI, USE_POSITIVE_LON)
    REAL(KIND=8), INTENT(INOUT) :: THETA
    REAL(KIND=8), INTENT(INOUT) :: PHI
    LOGICAL, INTENT(IN) :: USE_POSITIVE_LON
    
    IF (USE_POSITIVE_LON .AND. PHI < 0.0D0) THEN
      PHI = PHI + 360.0D0
    ELSE IF (.NOT. USE_POSITIVE_LON .AND. PHI > 0.0D0) THEN
      PHI = PHI - 360.0D0
    END IF
  END SUBROUTINE SET_THETAPHI_RANGE
END MODULE SET_THETAPHI_RANGE__genmod