MODULE DLS001_DEF
  IMPLICIT NONE
  SAVE
  INTEGER, PARAMETER :: LENRLS = 218, LENILS = 37
  DOUBLE PRECISION :: RLS(LENRLS)
  INTEGER :: ILS(LENILS)
END MODULE DLS001_DEF

SUBROUTINE DSRCOM(RSAV, ISAV, JOB)
  USE DLS001_DEF
  INTEGER, INTENT(IN) :: JOB
  INTEGER, INTENT(INOUT) :: ISAV(*)
  DOUBLE PRECISION, INTENT(INOUT) :: RSAV(*)
  INTEGER :: I
  IF (JOB == 2) THEN
    DO I = 1, LENRLS
      RLS(I) = RSAV(I)
    END DO
    DO I = 1, LENILS
      ILS(I) = ISAV(I)
    END DO
  ELSE
    DO I = 1, LENRLS
      RSAV(I) = RLS(I)
    END DO
    DO I = 1, LENILS
      ISAV(I) = ILS(I)
    END DO
  END IF
END SUBROUTINE DSRCOM

PROGRAM testDSRCOM
  USE DLS001_DEF
  IMPLICIT NONE
  INTEGER :: i
  INTEGER, DIMENSION(LENILS) :: ISAV
  DOUBLE PRECISION, DIMENSION(LENRLS) :: RSAV
  INTEGER :: JOB
  
  ! Initialize arrays with test data
  DO i = 1, LENRLS
     RSAV(i) = i * 1.0
  END DO

  DO i = 1, LENILS
     ISAV(i) = -i
  END DO

  ! Test JOB = 1
  JOB = 1
  CALL DSRCOM(RSAV, ISAV, JOB)
  
  ! Test JOB = 2
  JOB = 2
  CALL DSRCOM(RSAV, ISAV, JOB)

END PROGRAM testDSRCOM