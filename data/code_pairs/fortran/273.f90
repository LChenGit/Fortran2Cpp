SUBROUTINE SQZLGV(NPTIMS, IPTIMS, WHOTIM, VALIN, NPTOUT, VALOUT)
  INTEGER, INTENT(IN) :: NPTIMS
  INTEGER, INTENT(IN) :: IPTIMS(*)
  LOGICAL, INTENT(IN) :: WHOTIM(*)
  REAL, INTENT(IN) :: VALIN(*)
  REAL, INTENT(OUT) :: VALOUT(*)
  INTEGER, INTENT(OUT) :: NPTOUT

  INTEGER :: I
  
  NPTOUT = 0
  DO I = 1, NPTIMS
     IF (WHOTIM(IPTIMS(I))) THEN
        NPTOUT = NPTOUT + 1
        VALOUT(NPTOUT) = VALIN(I)
     END IF
  END DO
END SUBROUTINE SQZLGV