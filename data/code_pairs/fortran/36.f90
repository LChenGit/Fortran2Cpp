MODULE UHYPERMod
  IMPLICIT NONE
  INTEGER, PARAMETER :: DP=SELECTED_REAL_KIND(14)
  REAL(KIND=DP), PARAMETER :: ZERO=0._DP, ONE=1._DP, TWO=2._DP, THREE=3._DP
CONTAINS
  SUBROUTINE UHYPER(I1B, I2B, JAC, U, DU, D2U, D3U, TEMP, NOEL, CMNAME, &
       INCMPFLAG, NSTATEV, STATEV, NFIELDV, FIELDV, FIELDVINC, &
       NPROPS, PROPS)
    CHARACTER*8, INTENT(IN) :: CMNAME
    INTEGER, INTENT(IN) :: NPROPS, NOEL, NSTATEV, INCMPFLAG, NFIELDV
    REAL(KIND=DP), INTENT(IN) :: I1B, I2B, JAC, PROPS(NPROPS), TEMP
    REAL(KIND=DP), INTENT(INOUT) :: U(2), DU(3), D2U(6), D3U(6), STATEV(NSTATEV)
    REAL(KIND=DP), INTENT(INOUT) :: FIELDV(NFIELDV), FIELDVINC(NFIELDV)
    REAL(KIND=DP) :: C10, D1, U_VOL, U_DEV

    C10 = PROPS(1)
    D1 = PROPS(2)

    U_VOL = ONE / D1 * (JAC - ONE) ** 2
    U_DEV = C10 * (I1B - THREE)
    U(1) = U_VOL + U_DEV
    U(2) = U_DEV

    DU(1) = C10
    DU(2) = ZERO
    DU(3) = TWO / D1 * (JAC - ONE)

    D2U(1) = ZERO
    D2U(2) = ZERO
    D2U(3) = TWO / D1
    D2U(4) = ZERO
    D2U(5) = ZERO
    D2U(6) = ZERO

    D3U(1) = ZERO
    D3U(2) = ZERO
    D3U(3) = ZERO
    D3U(4) = ZERO
    D3U(5) = ZERO
    D3U(6) = ZERO
  END SUBROUTINE UHYPER
END MODULE UHYPERMod

PROGRAM TestUHYPER
  USE UHYPERMod
  IMPLICIT NONE
  REAL(KIND=DP) :: U(2), DU(3), D2U(6), D3U(6), PROPS(2), STATEV(1), FIELDV(1), FIELDVINC(1)
  REAL(KIND=DP) :: I1B, I2B, JAC, TEMP
  INTEGER :: NOEL, NPROPS, NSTATEV, INCMPFLAG, NFIELDV
  CHARACTER(LEN=8) :: CMNAME

  ! Set test values
  I1B = 2.0_DP
  I2B = 3.0_DP
  JAC = 1.1_DP
  TEMP = 298.15_DP
  NOEL = 1
  CMNAME = 'TEST'
  INCMPFLAG = 0
  NSTATEV = 1
  NFIELDV = 1
  NPROPS = 2
  PROPS(1) = 1.0_DP
  PROPS(2) = 2.0_DP

  ! Call the subroutine
  CALL UHYPER(I1B, I2B, JAC, U, DU, D2U, D3U, TEMP, NOEL, CMNAME, &
       INCMPFLAG, NSTATEV, STATEV, NFIELDV, FIELDV, FIELDVINC, NPROPS, PROPS)

  ! Output results for verification
  PRINT *, 'U:', U
  PRINT *, 'DU:', DU
  PRINT *, 'D2U:', D2U
  PRINT *, 'D3U:', D3U

END PROGRAM TestUHYPER