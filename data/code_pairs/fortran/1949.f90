! funden.f90
FUNCTION FUNDEN(SAL, SED, TEM) RESULT(RHO)
  IMPLICIT NONE
  DOUBLE PRECISION, INTENT(IN) :: SAL, SED, TEM
  DOUBLE PRECISION :: RHO
  DOUBLE PRECISION :: SSG, SDEN, SSTMP, TTMP, RHTMP

  SSG = 2.5
  SDEN = 1./2500000.
  SSTMP = SAL
  TTMP = TEM
  RHTMP = 999.842594 + 6.793952E-2*TTMP - 9.095290E-3*TTMP**2 +
     & 1.001685E-4*TTMP**3 - 1.120083E-6*TTMP**4 +
     & 6.536332E-9*TTMP**5
  RHO = RHTMP + SSTMP*(0.824493 - 4.0899E-3*TTMP + 7.6438E-5*TTMP**2 -
     & 8.2467E-7*TTMP**3 + 5.3875E-9*TTMP**4) +
     & SQRT(SSTMP)*SSTMP*(-5.72466E-3 + 1.0227E-4*TTMP -
     & 1.6546E-6*TTMP**2) + 4.8314E-4*SSTMP**2
  RHO = RHO * ((1. - SDEN*SED) + (SSG - 1.)*SDEN*SED)
END FUNCTION FUNDEN