PROGRAM TestCSEDTAUB
  IMPLICIT NONE
  DOUBLE PRECISION :: result
  DOUBLE PRECISION :: DENBULK

  ! Test case 1
  DENBULK = 1000.0D0
  result = CSEDTAUB(DENBULK, 0.0D0, 0.0D0, 0.0D0, 0.0D0, 1)
  PRINT *, 'Test case 1 (IOPT=1): Result:', result

  ! Test case 2
  DENBULK = 950.0D0
  result = CSEDTAUB(DENBULK, 0.0D0, 0.0D0, 0.0D0, 0.0D0, 2)
  PRINT *, 'Test case 2 (IOPT=2): Result:', result

CONTAINS

  DOUBLE PRECISION FUNCTION CSEDTAUB(DENBULK, TDUM, V1, V2, V3, IOPT)
    IMPLICIT NONE
    DOUBLE PRECISION, INTENT(IN) :: DENBULK, TDUM, V1, V2, V3
    INTEGER, INTENT(IN) :: IOPT
    DOUBLE PRECISION :: BULKDEN

    IF (IOPT .EQ. 1 .OR. IOPT .EQ. 2) THEN
      BULKDEN = 0.001 * DENBULK
      IF (BULKDEN .LE. 1.013) THEN
        CSEDTAUB = 0.0
      ELSE
        CSEDTAUB = 0.001 * (9.808 * BULKDEN - 9.934)
      END IF
    ELSE
      PRINT *, 'CSEDTAUB: BAD SEDIMENT CRITICAL STRESS OPTION! STOPPING!'
      STOP
    END IF
  END FUNCTION CSEDTAUB

END PROGRAM TestCSEDTAUB