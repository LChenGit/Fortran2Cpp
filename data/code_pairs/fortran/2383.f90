PROGRAM TEST
    IMPLICIT NONE
    INTEGER NDIM, IJAC
    DOUBLE PRECISION T
    DOUBLE PRECISION U(2), PAR(3), F(2), DFDU(4), DFDP(3)
    INTEGER ICP(1)

    NDIM = 2
    IJAC = 0
    T = 0.0D0

    CALL STPNT(NDIM, U, PAR, T)
    CALL FUNC(NDIM, U, ICP, PAR, IJAC, F, DFDU, DFDP)

    PRINT *, 'U:', U(1), U(2)
    PRINT *, 'PAR:', PAR(1), PAR(2), PAR(3)
    PRINT *, 'F:', F(1), F(2)

END PROGRAM TEST

SUBROUTINE FUNC(NDIM, U, ICP, PAR, IJAC, F, DFDU, DFDP)
    IMPLICIT NONE
    INTEGER NDIM, IJAC, ICP(*)
    DOUBLE PRECISION U(NDIM), PAR(*), F(NDIM), DFDU(*), DFDP(*)
    DOUBLE PRECISION U1, U2, E

    U1 = U(1)
    U2 = U(2)

    E = EXP(U2)

    F(1) = -U1 + PAR(1) * (1 - U1) * E
    F(2) = -U2 + PAR(1) * PAR(2) * (1 - U1) * E - PAR(3) * U2

END SUBROUTINE FUNC

SUBROUTINE STPNT(NDIM, U, PAR, T)
    IMPLICIT NONE
    INTEGER NDIM
    DOUBLE PRECISION U(NDIM), PAR(*), T

    PAR(1) = 0.0D0
    PAR(2) = 8.0D0
    PAR(3) = 3.0D0

    U(1) = 0.0D0
    U(2) = 0.0D0

END SUBROUTINE STPNT

SUBROUTINE BCND
END SUBROUTINE BCND

SUBROUTINE ICND
END SUBROUTINE ICND

SUBROUTINE FOPT
END SUBROUTINE FOPT

SUBROUTINE PVLS
END SUBROUTINE PVLS