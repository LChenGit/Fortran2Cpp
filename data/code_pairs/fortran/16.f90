MODULE deri23_I
  IMPLICIT NONE
  INTEGER, PARAMETER :: DOUBLE = SELECTED_REAL_KIND(p=15, r=307)
  INTERFACE
    SUBROUTINE deri23(F, FD, E, FCI, CMO, EMO, n)
      INTEGER, INTENT(IN) :: n
      REAL(DOUBLE), DIMENSION(n), INTENT(IN) :: F, FD, E, FCI
      REAL(DOUBLE), DIMENSION(n), INTENT(OUT) :: CMO
      REAL(DOUBLE), DIMENSION(n) :: EMO
    END SUBROUTINE deri23
  END INTERFACE
END MODULE deri23_I

PROGRAM test_deri23
  USE deri23_I
  IMPLICIT NONE
  INTEGER, PARAMETER :: n = 5, DOUBLE = SELECTED_REAL_KIND(p=15, r=307)
  REAL(DOUBLE) :: F(n) = [1.0_DOUBLE, 2.0_DOUBLE, 3.0_DOUBLE, 4.0_DOUBLE, 5.0_DOUBLE]
  REAL(DOUBLE) :: FD(n) = [5.0_DOUBLE, 4.0_DOUBLE, 3.0_DOUBLE, 2.0_DOUBLE, 1.0_DOUBLE]
  REAL(DOUBLE) :: E(n) = [2.0_DOUBLE, 2.0_DOUBLE, 2.0_DOUBLE, 2.0_DOUBLE, 2.0_DOUBLE]
  REAL(DOUBLE) :: FCI(n) = [1.0_DOUBLE, 1.0_DOUBLE, 1.0_DOUBLE, 1.0_DOUBLE, 1.0_DOUBLE]
  REAL(DOUBLE) :: CMO(n)
  REAL(DOUBLE) :: EMO(n)

  CALL deri23(F, FD, E, FCI, CMO, EMO, n)

  PRINT *, "CMO:", CMO
  PRINT *, "EMO:", EMO
END PROGRAM test_deri23

SUBROUTINE deri23(F, FD, E, FCI, CMO, EMO, n)
  USE deri23_I
  INTEGER, INTENT(IN) :: n
  REAL(DOUBLE), DIMENSION(n), INTENT(IN) :: F, FD, E, FCI
  REAL(DOUBLE), DIMENSION(n), INTENT(OUT) :: CMO
  REAL(DOUBLE), DIMENSION(n) :: EMO

  INTEGER :: i
  DO i = 1, n
    CMO(i) = F(i) * 2.0_DOUBLE  ! Example operation
    EMO(i) = F(i) + 1.0_DOUBLE  ! Example operation
  END DO
END SUBROUTINE deri23