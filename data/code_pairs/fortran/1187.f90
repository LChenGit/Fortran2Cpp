MODULE SMOOTH_WEIGHTS_CAP_VARDEGREE__genmod
  INTERFACE 
    SUBROUTINE SMOOTH_WEIGHTS_CAP_VARDEGREE(LON,LAT,XLON,XLAT,  &
 &WEIGHT,CAP_DEGREE,NTHETA,NPHI)
      INTEGER(KIND=4) :: NPHI
      INTEGER(KIND=4) :: NTHETA
      REAL(KIND=8) :: LON
      REAL(KIND=8) :: LAT
      REAL(KIND=8) :: XLON(NTHETA*NPHI)
      REAL(KIND=8) :: XLAT(NTHETA*NPHI)
      REAL(KIND=8) :: WEIGHT(NTHETA*NPHI)
      REAL(KIND=8) :: CAP_DEGREE
    END SUBROUTINE SMOOTH_WEIGHTS_CAP_VARDEGREE
  END INTERFACE 
END MODULE SMOOTH_WEIGHTS_CAP_VARDEGREE__genmod

PROGRAM Main
  USE SMOOTH_WEIGHTS_CAP_VARDEGREE__genmod
  IMPLICIT NONE
  
  INTEGER(KIND=4) :: NPHI, NTHETA
  REAL(KIND=8) :: LON, LAT, CAP_DEGREE
  REAL(KIND=8), ALLOCATABLE :: XLON(:), XLAT(:), WEIGHT(:)
  
  LON = 0.0D0
  LAT = 0.0D0
  CAP_DEGREE = 1.0D0
  NTHETA = 2
  NPHI = 2
  ALLOCATE(XLON(NTHETA*NPHI), XLAT(NTHETA*NPHI), WEIGHT(NTHETA*NPHI))
  
  XLON = [0.0D0, 1.0D0, 0.0D0, 1.0D0]
  XLAT = [0.0D0, 0.0D0, 1.0D0, 1.0D0]
  WEIGHT = [0.0D0, 0.0D0, 0.0D0, 0.0D0]
  
  CALL SMOOTH_WEIGHTS_CAP_VARDEGREE(LON, LAT, XLON, XLAT, WEIGHT, CAP_DEGREE, NTHETA, NPHI)
  
  PRINT *, "WEIGHTS:", WEIGHT
  
  DEALLOCATE(XLON, XLAT, WEIGHT)
END PROGRAM Main