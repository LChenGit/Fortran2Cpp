PROGRAM TestDD2TF
  IMPLICIT NONE
  CHARACTER(LEN=1) :: SIGN
  INTEGER, DIMENSION(4) :: IHMSF
  INTEGER :: NDP
  DOUBLE PRECISION :: DAYS

  CALL sla_DD2TF(3, 1.34567D0, SIGN, IHMSF)

  PRINT *, 'Sign: ', SIGN
  PRINT *, 'IHMSF: ', IHMSF

CONTAINS

  SUBROUTINE sla_DD2TF (NDP, DAYS, SIGN, IHMSF)
    IMPLICIT NONE
    INTEGER NDP
    DOUBLE PRECISION DAYS
    CHARACTER SIGN*(*)
    INTEGER IHMSF(4)
    DOUBLE PRECISION D2S
    PARAMETER (D2S=86400D0)
    INTEGER NRS,N
    DOUBLE PRECISION RS,RM,RH,A,AH,AM,AS,AF

    IF (DAYS.GE.0D0) THEN
       SIGN='+'
    ELSE
       SIGN='-'
    END IF

    NRS=1
    DO N=1,NDP
       NRS=NRS*10
    END DO
    RS=DBLE(NRS)
    RM=RS*60D0
    RH=RM*60D0

    A=ANINT(RS*D2S*ABS(DAYS))

    AH=AINT(A/RH)
    A=A-AH*RH
    AM=AINT(A/RM)
    A=A-AM*RM
    AS=AINT(A/RS)
    AF=A-AS*RS

    IHMSF(1)=NINT(AH)
    IHMSF(2)=NINT(AM)
    IHMSF(3)=NINT(AS)
    IHMSF(4)=NINT(AF)
  END SUBROUTINE sla_DD2TF

END PROGRAM TestDD2TF