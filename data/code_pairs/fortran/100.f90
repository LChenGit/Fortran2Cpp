PROGRAM TEST_ODE2
  IMPLICIT NONE
  DOUBLE PRECISION :: A, B, C, RT1, RT2

  ! Test case
  A = 1.0D0
  B = 2.0D0
  C = 3.0D0
  CALL ODE2(A, B, C, RT1, RT2)
  PRINT *, "Test 1: A=", A, "B=", B, "C=", C, "RT1=", RT1, "RT2=", RT2
END PROGRAM TEST_ODE2

SUBROUTINE ODE2(A, B, C, RT1, RT2)
  DOUBLE PRECISION A, B, C, RT1, RT2
  DOUBLE PRECISION ONE, TWO, ZERO, HALF
  DOUBLE PRECISION AB, ACMN, ACMX, ADF, DF, RT, SM, TB
  PARAMETER (ONE = 1.0D0, TWO = 2.0D0, ZERO = 0.0D0, HALF = 0.5D0)

  SM = A + C
  DF = A - C
  ADF = ABS(DF)
  TB = B + B
  AB = ABS(TB)
  IF (ABS(A) > ABS(C)) THEN
     ACMX = A
     ACMN = C
  ELSE
     ACMX = C
     ACMN = A
  END IF
  IF (ADF > AB) THEN
     RT = ADF * SQRT(ONE + (AB / ADF)**2)
  ELSE IF (ADF < AB) THEN
     RT = AB * SQRT(ONE + (ADF / AB)**2)
  ELSE
     RT = AB * SQRT(TWO)
  END IF
  IF (SM < ZERO) THEN
     RT1 = HALF * (SM - RT)
     RT2 = (ACMX / RT1) * ACMN - (B / RT1) * B
  ELSE IF (SM > ZERO) THEN
     RT1 = HALF * (SM + RT)
     RT2 = (ACMX / RT1) * ACMN - (B / RT1) * B
  ELSE
     RT1 = HALF * RT
     RT2 = -HALF * RT
  END IF
END SUBROUTINE ODE2