MODULE vast_kind_param
  INTEGER, PARAMETER :: DOUBLE = SELECTED_REAL_KIND(15, 307)
END MODULE vast_kind_param

MODULE drcout_I
  INTERFACE
    SUBROUTINE drcout(XYZ3, GEO3, VEL3, NVAR, TIME, ESCF3, EKIN3, ETOT3, XTOT3, ILOOP, CHARGE, FRACT, TEXT1, TEXT2, II, JLOOP)
      USE vast_kind_param, ONLY: DOUBLE
      INTEGER, INTENT(IN) :: NVAR
      REAL(DOUBLE), INTENT(IN) :: XYZ3(3, NVAR), GEO3(3, NVAR), VEL3(3, NVAR)
      REAL(DOUBLE), INTENT(IN) :: TIME, ESCF3(3), EKIN3(3), ETOT3(3), XTOT3(3), CHARGE(NVAR), FRACT
      CHARACTER(LEN=*), INTENT(IN) :: TEXT1, TEXT2
      INTEGER, INTENT(IN) :: II
      INTEGER, INTENT(INOUT) :: JLOOP
    END SUBROUTINE drcout
  END INTERFACE
END MODULE drcout_I

PROGRAM test_drcout
  USE drcout_I
  USE vast_kind_param, ONLY: DOUBLE
  IMPLICIT NONE

  INTEGER :: NVAR = 3, ILOOP = 2, II = 1, JLOOP = 0
  REAL(DOUBLE) :: TIME = 10.0, FRACT = 0.3
  REAL(DOUBLE), DIMENSION(3,3) :: XYZ3 = RESHAPE([1.0_DOUBLE, 2.0, 3.0, 4.0, 5.0, 6.0, 7.0, 8.0, 9.0], [3,3])
  REAL(DOUBLE), DIMENSION(3,3) :: GEO3 = RESHAPE([1.1_DOUBLE, 2.1, 3.1, 4.1, 5.1, 6.1, 7.1, 8.1, 9.1], [3,3])
  REAL(DOUBLE), DIMENSION(3,3) :: VEL3 = RESHAPE([0.1_DOUBLE, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9], [3,3])
  REAL(DOUBLE), DIMENSION(3) :: ESCF3 = [1.0_DOUBLE, 2.0, 3.0], EKIN3 = [4.0, 5.0, 6.0], ETOT3 = [7.0, 8.0, 9.0], XTOT3 = [10.0, 11.0, 12.0]
  REAL(DOUBLE), DIMENSION(NVAR) :: CHARGE = [0.5_DOUBLE, 0.6, 0.7]
  CHARACTER(LEN=3) :: TEXT1 = 'ABC'
  CHARACTER(LEN=2) :: TEXT2 = 'XY'

  CALL drcout(XYZ3, GEO3, VEL3, NVAR, TIME, ESCF3, EKIN3, ETOT3, XTOT3, ILOOP, CHARGE, FRACT, TEXT1, TEXT2, II, JLOOP)
END PROGRAM test_drcout

SUBROUTINE drcout(XYZ3, GEO3, VEL3, NVAR, TIME, ESCF3, EKIN3, ETOT3, XTOT3, ILOOP, CHARGE, FRACT, TEXT1, TEXT2, II, JLOOP)
  USE vast_kind_param, ONLY: DOUBLE
  INTEGER, INTENT(IN) :: NVAR, ILOOP, II
  INTEGER, INTENT(INOUT) :: JLOOP
  REAL(DOUBLE), INTENT(IN) :: XYZ3(3, NVAR), GEO3(3, NVAR), VEL3(3, NVAR), TIME, ESCF3(3), EKIN3(3), ETOT3(3), XTOT3(3), CHARGE(NVAR), FRACT
  CHARACTER(LEN=*), INTENT(IN) :: TEXT1, TEXT2

  PRINT *, 'XYZ3:'
  PRINT *, XYZ3
  PRINT *, 'GEO3:'
  PRINT *, GEO3
  PRINT *, 'VEL3:'
  PRINT *, VEL3
  PRINT *, 'TIME:', TIME
  PRINT *, 'ESCF3:', ESCF3
  PRINT *, 'EKIN3:', EKIN3
  PRINT *, 'ETOT3:', ETOT3
  PRINT *, 'XTOT3:', XTOT3
  PRINT *, 'ILOOP:', ILOOP
  PRINT *, 'CHARGE:', CHARGE
  PRINT *, 'FRACT:', FRACT
  PRINT *, 'TEXT1:', TEXT1
  PRINT *, 'TEXT2:', TEXT2
  PRINT *, 'II:', II
  PRINT *, 'JLOOP:', JLOOP
END SUBROUTINE drcout