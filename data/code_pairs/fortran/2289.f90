PROGRAM TestXLAENV
    IMPLICIT NONE
    INTEGER :: ISPEC, NVALUE
    INTEGER :: IPARMS(100)
    COMMON /CLAENV/ IPARMS

    CALL InitializeIPARMS()

    ISPEC = 5
    NVALUE = 10
    CALL XLAENV(ISPEC, NVALUE)
    PRINT *, 'IPARMS(5) = ', IPARMS(5)

    ISPEC = 3
    NVALUE = 20
    CALL XLAENV(ISPEC, NVALUE)
    PRINT *, 'IPARMS(3) = ', IPARMS(3)

    ISPEC = 10
    NVALUE = 30
    CALL XLAENV(ISPEC, NVALUE)
    PRINT *, 'IPARMS(10) = ', IPARMS(10)

END PROGRAM TestXLAENV

SUBROUTINE XLAENV(ISPEC, NVALUE)
    IMPLICIT NONE
    INTEGER, INTENT(IN) :: ISPEC, NVALUE
    INTEGER :: IPARMS(100)
    COMMON /CLAENV/ IPARMS

    IF (ISPEC >= 1 .AND. ISPEC <= 9) THEN
        IPARMS(ISPEC) = NVALUE
    END IF
END SUBROUTINE XLAENV

SUBROUTINE InitializeIPARMS()
    IMPLICIT NONE
    INTEGER :: IPARMS(100), I
    COMMON /CLAENV/ IPARMS

    DO I = 1, 100
        IPARMS(I) = 0
    END DO
END SUBROUTINE InitializeIPARMS