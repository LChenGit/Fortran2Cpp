PROGRAM TestHLUGPROJ
      IMPLICIT NONE
      DOUBLE PRECISION PHI0, LAMBDA0, PHI, LAMBDA, X, Y

      ! Example test coordinates
      PHI0 = 45.0
      LAMBDA0 = 10.0
      PHI = 50.0
      LAMBDA = 20.0

      CALL HLUGPROJ(PHI0, LAMBDA0, PHI, LAMBDA, X, Y)

      PRINT *, 'X:', X, 'Y:', Y

      END PROGRAM TestHLUGPROJ

      SUBROUTINE HLUGPROJ(PHI0, LAMBDA0, PHI, LAMBDA, X, Y)
      DOUBLE PRECISION PHI0, LAMBDA0, PHI, LAMBDA, X, Y
      DOUBLE PRECISION SIN0, COS0, SINP, COSP, SIND, COSD, DENOM
      DOUBLE PRECISION D2R
      PARAMETER (D2R = 0.017453292519943D0)
      SIN0 = SIN(D2R*PHI0)
      COS0 = COS(D2R*PHI0)
      SINP = SIN(D2R*PHI)
      COSP = COS(D2R*PHI)
      SIND = SIN(D2R*(LAMBDA-LAMBDA0))
      COSD = COS(D2R*(LAMBDA-LAMBDA0))
      DENOM = SIN0*SINP + COS0*COSP*COSD
      X = (COSP*SIND)/DENOM
      Y = (COS0*SINP - SIN0*COSP*COSD)/DENOM
      RETURN
      END